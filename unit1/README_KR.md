# ë‹¨ì› 1: ë””í“¨ì „ ëª¨ë¸ì— ëŒ€í•œ ì†Œê°œ

í—ˆê¹…í˜ì´ìŠ¤ì˜ ë””í“¨ì „ ëª¨ë¸ ì½”ìŠ¤ ì œ 1 ë‹¨ì›ì— ì˜¤ì‹ ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤! 1 ë‹¨ì›ì—ì„œëŠ” ë””í“¨ì „ ëª¨ë¸ì˜ ê¸°ë³¸ ì‘ë™ë²•ê³¼
ğŸ¤— Diffusers ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ì—¬ëŸ¬ë¶„ë§Œì˜ ë””í“¨ì „ ëª¨ë¸ì„ ë§Œë“œëŠ” ë°©ë²•ì— ëŒ€í•´ ì•Œì•„ë´…ë‹ˆë‹¤.

## ë‹¨ì›ì˜ ì‹œì‘ :rocket:

ì´ ë‹¨ì›ì€ ë‹¤ìŒì˜ ë‹¨ê³„ë¡œ êµ¬ì„±ë©ë‹ˆë‹¤

- [ì´ ì½”ìŠ¤ì— ê°€ì…](https://huggingface.us17.list-manage.com/subscribe?u=7f57e683fa28b51bfc493d048&id=ef963b4162)í•©ë‹ˆë‹¤. ê·¸ë˜ì•¼ ìƒˆë¡œìš´ ìë£Œê°€ ì¶”ê°€ë˜ì—ˆì„ ë•Œ ê·¸ ì†Œì‹ì„ ë°›ì•„ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- í¥ë¯¸ë¡œìš´ ì¶”ê°€ ìë£Œë¥¼ ì§ì ‘ ì°¾ì•„ë³´ëŠ” ê²ƒê³¼ í•¨ê»˜, ì•„ë˜ì˜ ì†Œê°œìš© ìë£Œë¥¼ ì½ì–´ë´…ë‹ˆë‹¤.
- ì´ë¡ ì´ ì‹¤ì œ ì½”ë“œë¡œ ì˜®ê²¨ì§€ëŠ” ê³¼ì •ì„ ğŸ¤— Diffusers ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ì‘ì„±ëœ _**Introduction to Diffusers**_ ë…¸íŠ¸ë¶ì„ í†µí•´ í™•ì¸í•©ë‹ˆë‹¤.
- ë…¸íŠ¸ë¶ ë˜ëŠ” ë§í¬ë¡œ ì œê³µë˜ëŠ” ë””í“¨ì „ ëª¨ë¸ì„ í•™ìŠµì‹œí‚¤ëŠ” ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•´ ì—¬ëŸ¬ë¶„ ë§Œì˜ ë””í“¨ì „ ëª¨ë¸ì„ í•™ìŠµì‹œí‚¤ê³  ê³µìœ í•©ë‹ˆë‹¤.
- (ì˜µì…˜) ë°‘ë°”ë‹¥ì—ì„œ ë¶€í„° ìµœì†Œí•œì˜ ì½”ë“œë¥¼ êµ¬í˜„í•˜ë©° ì„¤ê³„ìƒ ê´€ë ¨ëœ ì„œë¡œ ë‹¤ë¥¸ ê²°ì • ì‚¬í•­ì— ê´€ì‹¬ì´ ìˆë‹¤ë©´,  _**Diffusion Models from Scratch**_ ë…¸íŠ¸ë¶ì„ í†µí•´ ê·¸ ë‚´ìš©ì„ ê¹Šê²Œ ì´í•´í•´ ë´…ë‹ˆë‹¤.
- (ì˜µì…˜) ì´ ë‹¨ì›ì˜ ìë£Œë¥¼ ë¦´ë¦¬ì¦ˆ í•˜ê¸° ì „ ë¦¬í—ˆì„¤í•œ [ì´ ë¹„ë””ì˜¤](https://www.youtube.com/watch?v=09o5cv6u76c)ë¥¼ ì‹œì²­í•©ë‹ˆë‹¤.

:loudspeaker: [ë””ìŠ¤ì½”ë“œ ì„œë²„](https://huggingface.co/join/discord)ì— ê°€ì…í•˜ëŠ” ê²ƒì„ ìŠì§€ ë§ˆì„¸ìš”. `#diffusion-models-class` ì±„ë„ì—ì„œ ì´ ì½”ìŠ¤ê°€ ì œê³µí•˜ëŠ” ìë£Œë¥¼ ì‚¬ëŒë“¤ê³¼ í† ë¡ í•˜ê³ , ì—¬ëŸ¬ë¶„ì´ ë§Œë“  ê²°ê³¼ë¬¼ì„ ê³µìœ í•´ë³´ê¸° ë°”ëë‹ˆë‹¤.
 
## ë””í“¨ì „ ëª¨ë¸ì´ë€ ë¬´ì—‡ì¼ê¹Œìš”?

ë””í“¨ì „ ëª¨ë¸ì€ 'ìƒì„± ëª¨ë¸'ë¡œ ì•Œë ¤ì§„ ì•Œê³ ë¦¬ì¦˜ ê·¸ë£¹ì—, ë¹„êµì  ìµœê·¼ì— ì¶”ê°€ëœ ëª¨ë¸ì…ë‹ˆë‹¤. ìƒì„± ëª¨ë¸ì˜ ëª©í‘œëŠ” ì£¼ì–´ì§„ í•™ìŠµìš© ë°ì´í„°ì…‹ì— ê¸°ë°˜í•˜ì—¬, ì´ë¯¸ì§€ ë˜ëŠ” ì˜¤ë””ì˜¤ ê°™ì€ ë°ì´í„°ì˜ **ìƒì„±** ë°©ë²•ì„ í„°ë“í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ì˜ ë§Œë“¤ì–´ì§„ ìƒì„± ëª¨ë¸ì€ ê·¸ëŒ€ë¡œ ë³µì‚¬í•˜ì§€ ì•Šê³ ë„, í•™ìŠµìš© ë°ì´í„°ì™€ ë‹®ì€ **ë‹¤ì–‘í•œ** ì¶œë ¥ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë””í“¨ì „ ëª¨ë¸ì€ ì´ ëª©í‘œë¥¼ ì–´ë–»ê²Œ ë‹¬ì„±í•  ìˆ˜ ìˆì„ê¹Œìš”? ëª…í™•í•œ ì´í•´ë¥¼ ìœ„í•´ì„œ ì´ë¯¸ì§€ ìƒì„±ì— ëŒ€í•œ ê²½ìš°ì— ì§‘ì¤‘í•´ë³´ì£ .

<p align="center">
    <img src="https://user-images.githubusercontent.com/10695622/174349667-04e9e485-793b-429a-affe-096e8199ad5b.png" width="800"/>
    <br>
    <em> DDPM ë…¼ë¬¸ì—ì„œ ë°œì·Œí•œ ê·¸ë¦¼ (https://arxiv.org/abs/2006.11239). </em>
<p>

ë””í“¨ì „ ëª¨ë¸ì´ ì„±ê³µí•œ ì´ìœ , ê·¸ ë¹„ë°€ì€ ë””í“¨ì „ ê³¼ì •ì´ ê°€ì§„ ë°˜ë³µì ì¸ íŠ¹ì„± ì…ë‹ˆë‹¤. ìƒì„±ì€ ì„ì˜ì˜ ë…¸ì´ì¦ˆì—ì„œ ì‹œì‘í•˜ì§€ë§Œ, ì¶œë ¥ ì´ë¯¸ì§€ê°€ ë“œëŸ¬ë‚  ë•Œê¹Œì§€ ì—¬ëŸ¬ ë‹¨ê³„ë¥¼ ê±°ì³ ê°œì„ /ì •ì œë˜ì–´ ë‚˜ê°‘ë‹ˆë‹¤. ê° ë‹¨ê³„ë§ˆë‹¤ ëª¨ë¸ì€ í˜„ì¬ ì…ë ¥ì´ ì–´ë–»ê²Œ ë…¸ì´ì¦ˆê°€ ì™„ì „íˆ ê±·íŒ ìƒíƒœë¡œ ê°ˆ ìˆ˜ ìˆì„ì§€ë¥¼ ì¶”ì •í•©ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ë§¤ ë‹¨ê³„ë§ˆë‹¤ ì•½ê°„ì˜ ë³€í™”ë§Œ ë§Œë“¤ê¸° ë•Œë¬¸ì—, ì´ˆê¸° ë‹¨ê³„(ìµœì¢… ì¶œë ¥ì˜ ì˜ˆì¸¡ì´ ë§¤ìš° ì–´ë ¤ìš´ ë‹¨ê³„)ì—ì„œì˜ ì´ ì¶”ì •ì˜ ì˜¤ì°¨ëŠ” ì´í›„ ê°±ì‹ ì—ì„œ ìˆ˜ì •ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ëª¨ë¸ì„ í•™ìŠµì‹œí‚¤ëŠ” ê³¼ì •ì€ ë‹¤ë¥¸ ìƒì„± ëª¨ë¸ ëŒ€ë¹„, ë¹„êµì  ê°„ë‹¨í•œ í¸ì…ë‹ˆë‹¤. ë‹¤ìŒ ê³¼ì •ì„ ë°˜ë³µí•´ì„œ ìˆ˜í–‰í•˜ì£ 
1) í•™ìŠµìš© ë°ì´í„°ì—ì„œ ì¼ë¶€ ì´ë¯¸ì§€ë¥¼ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤
2) ì„œë¡œ ë‹¤ë¥¸ ì–‘ì˜ ë…¸ì´ì¦ˆë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤. ìš°ë¦¬ê°€ ì›í•˜ëŠ” ê²ƒì€ ë§¤ìš° ë…¸ì´ì¦ˆê°€ ì‹¬í•œ ì´ë¯¸ì§€ì™€ ì™„ë³€ê²Œ ê°€ê¹Œìš´ ì´ë¯¸ì§€ ëª¨ë‘ë¥¼ 'ê³ ì¹˜ëŠ”'ì¼ì„ ì˜ í•˜ëŠ” ëª¨ë¸ì´ë¼ëŠ” ê²ƒì„ ê¸°ì–µí•˜ì„¸ìš”.
3) ëª¨ë¸ì— ë…¸ì´ì¦ˆê°€ ë‚€ ë²„ì „ì˜ ì…ë ¥ì„ ì£¼ì…í•©ë‹ˆë‹¤.
4) ëª¨ë¸ì´ ì…ë ¥ì˜ ë…¸ì´ì¦ˆë¥¼ ì–¼ë§ˆë‚˜ ì˜ ê±·ì–´ë‚´ëŠ”ì§€ í‰ê°€í•©ë‹ˆë‹¤.
5) ì´ ì •ë³´ë¥¼ ì‚¬ìš©í•´ì„œ ëª¨ë¸ì˜ ê°€ì¤‘ì¹˜ë¥¼ ê°±ì‹ í•©ë‹ˆë‹¤.

í•™ìŠµëœ ëª¨ë¸ë¡œ ìƒˆë¡œìš´ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•˜ë ¤ë©´, ì™„ë²½í•œ ì„ì˜ì˜ ì…ë ¥(ë…¸ì´ì¦ˆ)ë¡œ ì‹œì‘í•´ì„œ, ì´ë¥¼ ëª¨ë¸ì— ë°˜ë³µì ìœ¼ë¡œ ì£¼ì…í•©ë‹ˆë‹¤. ë§¤ ë°˜ë³µë§ˆë‹¤ ëª¨ë¸ì˜ ì˜ˆì¸¡ì— ë”°ë¼ ì•½ê°„ì”© ë…¸ì´ì¦ˆë¥¼ ê°±ì‹ í•´ ë‚˜ê°€ì£ . ê³§ ë³´ê² ì§€ë§Œ ê°€ëŠ¥í•œ ì ì€ ë‹¨ê³„(ë°˜ë³µ)ìœ¼ë¡œ ì§ˆ ì¢‹ì€ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•  ìˆ˜ ìˆë„ë¡, ì´ ê³¼ì •ì„ ê°„ì†Œí™”í•´ì£¼ëŠ” ë‹¤ì–‘í•œ ìƒ˜í”Œë§ ê¸°ë²•ì´ ì¡´ì¬í•©ë‹ˆë‹¤.

1 ë‹¨ì›ì—ì„œëŠ” ê° ë‹¨ê³„ë¥¼ ì‹¤ìŠµìš© ë…¸íŠ¸ë¶ì„ í†µí•´ í•˜ë‚˜ì”© í™•ì¸í•©ë‹ˆë‹¤. ê·¸ë¦¬ê³  2 ë‹¨ì›ì—ì„œëŠ” ì´ ê³¼ì •ì„ ìˆ˜ì •í•˜ê³ , ì¶”ê°€ì ì¸ ì¡°ê±´(í´ë˜ìŠ¤ ë ˆì´ë¸” ë“±)ì´ë‚˜ ìœ ë„/ê°€ì´ë˜ìŠ¤(guidance)ê°™ì€ ê¸°ë²•ì„ í†µí•´ ëª¨ë¸ ì¶œë ¥ì„ ì œì–´í•˜ëŠ” ì¶”ê°€ì ì¸ ë°©ë²•ì„ ì‚´í´ë´…ë‹ˆë‹¤. ë§ˆì§€ë§‰ 3, 4 ë‹¨ì›ì—ì„œëŠ” í…ìŠ¤íŠ¸ì— ì•Œë§ì€ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•  ìˆ˜ ìˆëŠ” ë§¤ìš° ê°•ë ¥í•œ Stable Diffusion ì´ë¼ëŠ” ëª¨ë¸ì„ íƒêµ¬í•©ë‹ˆë‹¤.

## ì‹¤ìŠµìš© ë…¸íŠ¸ë¶

ì´ì œ ì œê³µë˜ëŠ” ë…¸íŠ¸ë¶ì„ ì‹œì‘í•˜ê¸°ì— ì¶©ë¶„í•œ ì§€ì‹ì„ ê°–ì·„ìŠµë‹ˆë‹¤! ì´ ë‹¨ì›ì´ ì œê³µí•˜ëŠ” ë‘ ë…¸íŠ¸ë¶ì€ ê°™ì€ ë‚´ìš©ì„ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ ë°”ë¼ë´…ë‹ˆë‹¤.
 
| ë…¸íŠ¸ë¶ ì´ë¦„                                     | ì½œë©                                                                                                                                                                                               | ìºê¸€                                                                                                                                                                                                   | Gradient                                                                                                                                                                               | ì•„ë§ˆì¡´ ìŠ¤íŠœë””ì˜¤ ë©                                                                                                                                                                                                   |
|:--------------------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Introduction to Diffusers                                | [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/huggingface/diffusion-models-class/blob/main/unit1/01_introduction_to_diffusers.ipynb)              | [![Kaggle](https://kaggle.com/static/images/open-in-kaggle.svg)](https://kaggle.com/kernels/welcome?src=https://github.com/huggingface/diffusion-models-class/blob/main/unit1/01_introduction_to_diffusers.ipynb)              | [![Gradient](https://assets.paperspace.io/img/gradient-badge.svg)](https://console.paperspace.com/github/huggingface/diffusion-models-class/blob/main/unit1/01_introduction_to_diffusers.ipynb)              | [![Open In SageMaker Studio Lab](https://studiolab.sagemaker.aws/studiolab.svg)](https://studiolab.sagemaker.aws/import/github/huggingface/diffusion-models-class/blob/main/unit1/01_introduction_to_diffusers.ipynb)              |
| Diffusion Models from Scratch                                | [![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/huggingface/diffusion-models-class/blob/main/unit1/02_diffusion_models_from_scratch.ipynb)              | [![Kaggle](https://kaggle.com/static/images/open-in-kaggle.svg)](https://kaggle.com/kernels/welcome?src=https://github.com/huggingface/diffusion-models-class/blob/main/unit1/02_diffusion_models_from_scratch.ipynb)              | [![Gradient](https://assets.paperspace.io/img/gradient-badge.svg)](https://console.paperspace.com/github/huggingface/diffusion-models-class/blob/main/unit1/02_diffusion_models_from_scratch.ipynb)              | [![Open In SageMaker Studio Lab](https://studiolab.sagemaker.aws/studiolab.svg)](https://studiolab.sagemaker.aws/import/github/huggingface/diffusion-models-class/blob/main/unit1/02_diffusion_models_from_scratch.ipynb)              |

In _**Introduction to Diffusers**_, we show the different steps described above using building blocks from the diffusers library. You'll quickly see how to create, train and sample your own diffusion models on whatever data you choose. By the end of the notebook, you'll be able to read and modify the example training script to train diffusion models and share them with the world! This notebook also introduces the main exercise associated with this unit, where we will collectively attempt to figure out good 'training recipes' for diffusion models at different scales - see the next section for more info.

In _**Diffusion Models from Scratch**_, we show those same steps (adding noise to data, creating a model, training and sampling) but implemented from scratch in PyTorch as simply as possible. Then we compare this 'toy example' with the diffusers version, noting how the two differ and where improvements have been made. The goal here is to gain familiarity with the different components and the design decisions that go into them so that when you look at a new implementation you can quickly identify the key ideas.

## Project Time

Now that you've got the basics down, have a go at training one or more diffusion models! Some suggestions are included at the end of the _**Introduction to Diffusers**_ notebook. Make sure to share your results, training recipes and findings with the community so that we can collectively figure out the best ways to train these models.

## Some Additional Resources
 
[The Annotated Diffusion Model](https://huggingface.co/blog/annotated-diffusion) is a very in-depth walk-through of the code and theory behind DDPMs with 
 maths and code showing all the different components. It also links to a number of papers for further reading.
 
Hugging Face documentation on [Unconditional Image-Generation](https://huggingface.co/docs/diffusers/training/unconditional_training) for some examples of how to train diffusion models using the official training example script, including code showing how to create your own dataset. 

AI Coffee Break video on Diffusion Models: https://www.youtube.com/watch?v=344w5h24-h8

Yannic Kilcher Video on DDPMs: https://www.youtube.com/watch?v=W-O7AZNzbzQ

Found more great resources? Let us know and we'll add them to this list.
